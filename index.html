<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Widget Training</title>
  </head>

  <body>
    <div class="dijitHidden">
      <div
        data-dojo-type="dijit/Dialog"
        style="width: 600px; height: 30vh"
        id="beerDialog"
        data-dojo-props="title:'Terms and Conditions'"
      >
        sdo;fijas;lfjas;dlfksdj;flkashdj;folkshd;flkahsd;flakshdf
        <div id="beerSelect"></div>
      </div>
    </div>

    <script>
      var dojoConfig = {
        async: true,
        dojoBlankHtmlUrl:
          location.pathname.replace(/\/[^/]+$/, "") + "/blank.html",
        packages: [
          {
            name: "widget",
            location: location.pathname.replace(/\/[^/]+$/, "") + "/widget",
          },
          {
            name: "modules",
            location: location.pathname.replace(/\/[^/]+$/, "") + "/modules",
          },
        ],
      };
    </script>
    <script src="//ajax.googleapis.com/ajax/libs/dojo/1.8.1/dojo/dojo.js"></script>
    <script>
      require([
        "dojo/dom",
        "dojo/dom-style",
        "dojo/parser",
        "dijit/Dialog",
        "dijit/registry",
        "dijit/form/Select",
        "dojo/store/Memory",
        "widget/WidgetTraining",
        "modules/fetchData.js",
        "dojo/domReady!",
      ], (
        dom,
        domStyle,
        parser,
        dialog,
        registry,
        Select,
        Memory,
        WidgetTraining,
        fetchData
      ) => {
        const url = "https://api.punkapi.com/v2/beers";
        const container = dom.byId("container");
        const under = dom.byId("under");

        showDialog = function () {
          registry.byId("beerDialog").show();
        };

        const widget = new WidgetTraining().placeAt(container);

        fetchData.getBeers(url).then((data) => {
          const beerStore = new Memory({
            idProperty: "abbreviation",
            data,
          });

          console.log(beerStore);

          const select = new Select(
            {
              name: "beerSelect",
              store: beerStore,
              style: "width: 200px;",
              labelAttr: "name",
              maxHeight: -1, // tells _HasDropDown to fit menu within viewport
              onChange: function (value) {
                document.getElementById("value").innerHTML = value;
                document.getElementById("displayedValue").innerHTML = this.get(
                  "displayedValue"
                );
              },
            },
            "beerSelect"
          );
          select.startup();

          widget.endLoading();
          // domStyle.set(container, "display", "none");
        });

        parser.parse();
      });
    </script>

    <div id="container"></div>
    <div id="under" class="under-overlay">
      <button onclick="showDialog()" class="under-btn">See the beer!</button>
    </div>
  </body>
</html>
